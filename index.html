<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Have fun!</title>

  <style>
    /* ===== Theme / Tunables ===== */
    :root{
      --bg: #e6e6e6;
      --fg: #f2f2f2;

      --size: 56;            /* cube face size (px) */
      --perspective: 600;    /* 3D depth */
      --tiltX: -28deg;
      --tiltY: 45deg;

      --movement: 0.85;
      --stop: 0.5;
      --duration: calc((var(--movement) * (1 / var(--stop))) * 1s);
      --stagger: 0.11s;

      --ease: cubic-bezier(1, -0.52, 0.26, 0.89);
      --border: 5px;
    }

    @media (prefers-color-scheme: dark) {
      :root { --bg: #151515; }
    }

    /* Optional custom font — keep if you still have the files */
    @font-face {
      font-family: "Secrets";
      src: url("i_tell_you_all_my_secrets-webfont.woff2") format("woff2"),
           url("i_tell_you_all_my_secrets-webfont.woff") format("woff");
      font-weight: 400;
      font-style: normal;
      font-display: swap;
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }

    body {
      margin: 0;
      display: grid;
      place-items: center;
      background: var(--bg);
      color: var(--fg);

      /* Keep no scrollbars, but we’ll avoid clipping via containment fix */
      overflow: hidden;

      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }

    main {
      width: min(100%, 980px);
      padding: 48px 24px; /* extra vertical room so jumps don’t feel tight */
      display: grid;
      place-items: center;
      gap: 16px;
    }

    .scene {
      perspective: calc(var(--perspective) * 1px);
      overflow: visible;
    }

    .word-wrap {
      position: relative;
      transform-style: preserve-3d;

      /* IMPORTANT: do NOT use `contain: paint;` or it will clip the animation */
      contain: layout;          /* optional perf win without clipping */
      overflow: visible;        /* allow the jump/3D to render outside bounds */
      isolation: isolate;       /* helps with stacking/3D compositing */
    }

    .word {
      display: flex;
      transform: translate(calc(var(--size) * 1.3px), 0) rotateX(var(--tiltX)) rotateY(var(--tiltY));
      transform-style: preserve-3d;
      align-items: flex-end;
      gap: calc(var(--size) * 0.18px);
    }

    /* Each letter wrapper bounces */
    .letter-wrap {
      transform-origin: bottom center;
      transform-style: preserve-3d;
      animation: jump var(--duration) calc(var(--stagger) * var(--i)) var(--ease) infinite;
      will-change: transform;
    }

    /* Each letter rotates (cube flips) */
    .letter {
      position: relative;
      width: calc(var(--size) * 1px);
      height: calc(var(--size) * 1px);
      transform-style: preserve-3d;

      font-family: "Secrets", system-ui, sans-serif;
      font-weight: 800;
      font-size: 3.2rem;
      line-height: 1;

      animation: spin calc(var(--duration) * 2) calc(var(--stagger) * var(--i)) ease infinite;
      will-change: transform;
    }

    /* Invisible spacer but keeps timing */
    .letter-wrap[data-space="true"] { opacity: 0; }

    .panel {
      --h: calc((360 / var(--letters)) * var(--i));
      position: absolute;
      inset: 0;
      display: grid;
      place-items: center;
      background: hsl(var(--h) 65% 40%);
      border: var(--border) solid hsl(var(--h) 100% 50%);
      backface-visibility: hidden;
      transform-style: preserve-3d;
      box-shadow: 0 6px 16px rgba(0,0,0,.18);
    }

    /* Cube faces */
    .panel.front { transform: translateZ(calc(var(--size) * 0.5px)); }
    .panel.top   { transform: rotateX( 90deg) translateZ(calc(var(--size) * 0.5px)); }
    .panel.back  { transform: rotateX(180deg) translateZ(calc(var(--size) * 0.5px)); }
    .panel.bot   { transform: rotateX(-90deg) translateZ(calc(var(--size) * 0.5px)); }
    .panel.left  { transform: rotateY(-90deg) translateZ(calc(var(--size) * 0.5px)); }

    /* Shadow layer */
    .shadow-row {
      position: absolute;
      left: 0;
      bottom: -6px;
      display: flex;
      gap: calc(var(--size) * 0.18px);
      transform-style: preserve-3d;
      pointer-events: none;
      overflow: visible;
    }

    .shadow {
      width: calc(var(--size) * 1px);
      height: calc(var(--size) * 1px);
      transform-origin: center;
      filter: blur(10px);
      transform: rotateX(90deg) translateZ(calc(var(--size) * -0.55px));
      animation: shadowScale var(--duration) calc(var(--stagger) * var(--i)) var(--ease) infinite;
      background: radial-gradient(rgba(0,0,0,.45), transparent 65%) 50% 50%;
      opacity: 0.85;
    }

    /* Animations */
    @keyframes spin {
      0%, 15%   { transform: rotateX(0deg); }
      20%, 65%  { transform: rotateX(270deg); }
      70%, 100% { transform: rotateX(540deg); }
    }

    @keyframes jump {
      0%, 50%, 100% { transform: scaleX(1) scaleY(1) translateY(0); }
      15%           { transform: scaleX(1.18) scaleY(0.82) translateY(0); }
      25%           { transform: scaleX(0.92) scaleY(1.08) translateY(-100%); }
    }

    @keyframes shadowScale {
      0%, 20%, 50%, 100% { transform: rotateX(90deg) translateZ(calc(var(--size) * -0.55px)) scale(1); }
      25%                { transform: rotateX(90deg) translateZ(calc(var(--size) * -0.55px)) scale(1.25); }
    }

    /* Accessibility: reduce motion */
    @media (prefers-reduced-motion: reduce) {
      .letter-wrap, .letter, .shadow { animation: none !important; }
    }
  </style>
</head>

<body>
  <main>
    <div class="scene" aria-label="Intro animation">
      <div class="word-wrap">
        <div class="word" id="word" aria-hidden="true"></div>
        <div class="shadow-row" id="shadows" aria-hidden="true"></div>
      </div>
    </div>
  </main>

  <script>
    // Redirect + countdown DISABLED for now (optimization mode)
    const CONFIG = {
      text: "HAVE FUN!",
      enableRedirect: false,
      redirectUrl: "https://example.com",
      delayMs: 5000
    };

    const wordEl = document.getElementById("word");
    const shadowEl = document.getElementById("shadows");

    // Build letters from text (keeps your stagger timing)
    const chars = [...CONFIG.text];
    document.documentElement.style.setProperty("--letters", String(chars.length));

    chars.forEach((ch, i) => {
      const wrap = document.createElement("div");
      wrap.className = "letter-wrap";
      wrap.style.setProperty("--i", i);

      if (ch === " ") wrap.dataset.space = "true";

      const letter = document.createElement("div");
      letter.className = "letter";
      letter.style.setProperty("--i", i);

      const faces = [
        ["front", ch],
        ["top", ch],
        ["back", ch],
        ["bot", ch],
        ["left", ""]
      ];

      faces.forEach(([cls, txt]) => {
        const panel = document.createElement("span");
        panel.className = `panel ${cls}`;
        panel.textContent = txt;
        letter.appendChild(panel);
      });

      wrap.appendChild(letter);
      wordEl.appendChild(wrap);

      const shadow = document.createElement("div");
      shadow.className = "shadow";
      shadow.style.setProperty("--i", i);
      shadowEl.appendChild(shadow);
    });

    // Optional: enable redirect later by flipping enableRedirect to true.
    if (CONFIG.enableRedirect) {
      setTimeout(() => window.location.assign(CONFIG.redirectUrl), CONFIG.delayMs);
    }
  </script>
</body>
</html>
